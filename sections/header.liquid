<header class="bg-white shadow-md px-4 py-3">
  <div class="container mx-auto flex items-center justify-between">

    <!-- Left: Logo -->
    <div class="flex items-center">
      <a href="{{ shop.url }}" title="{{ shop.name }}" class="text-2xl font-medium text-black uppercase">
        {%- if settings.logo != blank -%}
          <img src="{{ logo | img_url: 'master' }}" alt="{{ shop.name }}">
        {%- else -%}
          {{ shop.name }}
        {%- endif -%}
      </a>
    </div>

    <!-- Middle: Menu -->
    <nav>
      <ul class="hidden md:flex gap-6">
        {%- assign links = section.settings.header_menu.links -%}
        {%- for link in links -%}
          <li class="relative group">
            <a 
              href="{{ link.url }}" 
              class="clip-hover inline-flex items-center gap-1.5 2xl:mx-1 my-[31px] font-medium capitalize text-lg transition-all duration-500 relative z-10 overflow-hidden 
              {% if link.url == request.path %}text-green-500{% else %}text-black{% endif %}"
            >
              {{ link.title }}
            </a>

            {%- if link.links.size > 0 -%}
              <ul class="absolute z-50 -left-1 top-full origin-top w-64 bg-white text-HeadingColor-0 rounded-md border-t-[3px] border-green-500 shadow-cases scale-y-0 transition-all duration-500 opacity-0 invisible group-hover:opacity-100 group-hover:visible group-hover:scale-y-100">
                {%- for childlink in link.links -%}
                  {% assign is_child_active = false %}

                  {%- if childlink.url == request.path -%}
                    {% assign is_child_active = true %}
                  {%- endif -%}

                  {%- if childlink.links.size > 0 -%}
                    {%- for grandchild in childlink.links -%}
                      {%- if grandchild.url == request.path -%}
                        {% assign is_child_active = true %}
                      {%- endif -%}
                    {%- endfor -%}
                  {%- endif -%}

                  <li class="relative z-10 group/submenu">
                    <a 
                      href="{{ childlink.url }}" 
                      class="flex justify-between px-7 py-3 border-b border-black/10 font-medium transition-all duration-500 relative z-10 
                            before:absolute before:left-0 before:top-auto before:bottom-0 before:w-full before:h-0 before:bg-green-500 
                            before:transition-all before:duration-500 before:-z-10 
                            hover:before:h-full hover:bottom-auto hover:before:top-0 hover:text-white 
                            {% if is_child_active %}before:h-full text-white{% endif %}"
                    >
                      {{ childlink.title }}
                      {%- if childlink.links.size > 0 -%}
                        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                      {%- endif -%}
                    </a>

                    {%- if childlink.links.size > 0 -%}
                      <ul class="absolute top-0 left-full w-64 bg-white text-HeadingColor-0 rounded-md border-t-[3px] border-green-500 shadow-shade scale-y-0 opacity-0 invisible origin-top-left transition-all duration-500 group-hover/submenu:opacity-100 group-hover/submenu:visible group-hover/submenu:scale-y-100">
                        {%- for grandchild in childlink.links -%}
                          <li>
                            <a 
                              href="{{ grandchild.url }}" 
                              class="block px-5 py-3 border-b border-black/10 font-Outfit font-medium transition-all duration-500 relative z-10 
                                    before:absolute before:left-0 before:top-auto before:bottom-0 before:w-full before:h-0 before:bg-green-500 
                                    before:transition-all before:duration-500 before:-z-10 
                                    hover:before:h-full hover:bottom-auto hover:before:top-0 hover:text-white 
                                    {% if grandchild.url == request.path %}before:h-full text-white{% endif %}"
                            >
                              {{ grandchild.title }}
                            </a>
                          </li>
                        {%- endfor -%}
                      </ul>
                    {%- endif -%}
                  </li>
                {%- endfor -%}
              </ul>
            {%- endif -%}
          </li>
        {%- endfor -%}
      </ul>
    </nav>




    <!-- Right: Icons -->
    <div class="flex items-center space-x-4">

      <!-- Search -->
      <button class="p-2 text-gray-600 hover:text-blue-600">
        {%- render 'icons', icon: "search" -%}
      </button>

      <!-- Cart -->
      <button class="p-2 text-gray-600 hover:text-blue-600 relative">
        {%- render 'icons', icon: "bag" -%}
        <span class="absolute top-1 right-1 bg-red-500 text-white text-xs px-1 rounded-full">{{ shop.cart_item }}</span>
      </button>

      <!-- Language -->
      <select class="border rounded px-2 py-1 text-gray-700 text-sm focus:outline-none">
        <option>EN</option>
        <option>BN</option>
        <option>FR</option>
      </select>

      <!-- Profile -->
      <button class="p-2 text-gray-600 hover:text-blue-600">
        LogIn
      </button>

    </div>
  </div>
</header>


{% schema %}
  {
    "name": "Header Section",
    "tag": "section",
    "class": "header-section",
    "settings": [
      {
        "type": "link_list",
        "id": "header_menu",
        "label": "Select Header Menu"
      },
    ],
    "presets": [
      {
        "name": "Header Section",
        "settings": {
        }
      }
    ]
  }
{% endschema %}